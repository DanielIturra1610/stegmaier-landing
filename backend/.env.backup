# ================================
# Stegmaier LMS - Backend Configuration
# ================================

# --------------------------------
# Environment
# --------------------------------
ENV=development
# Options: development, staging, production

# --------------------------------
# Server Configuration
# --------------------------------
SERVER_PORT=8080
SERVER_HOST=localhost
SERVER_READ_TIMEOUT=30s
SERVER_WRITE_TIMEOUT=30s

# --------------------------------
# Database Configuration (PostgreSQL)
# --------------------------------

# Control Database (shared: users, tenants, tokens)
DB_HOST=localhost
DB_PORT=5432
DB_USER=postgres
DB_PASSWORD=postgres
DB_NAME=stegmaier_control
DB_SSL_MODE=disable
# Options for DB_SSL_MODE: disable, require, verify-ca, verify-full

# Connection Pool
DB_MAX_OPEN_CONNS=25
DB_MAX_IDLE_CONNS=5
DB_CONN_MAX_LIFETIME=5m

# Tenant Database Template
TENANT_DB_PREFIX=stegmaier_tenant_
# Example: For tenant "acme" -> stegmaier_tenant_acme

# --------------------------------
# JWT Configuration
# --------------------------------
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production-min-32-chars
JWT_EXPIRATION=24h
# Options: 15m, 1h, 24h, 168h (7 days)

JWT_REFRESH_EXPIRATION=168h
# Refresh token duration (typically 7 days)

JWT_ISSUER=stegmaier-lms
# Token issuer name

# --------------------------------
# Password & Security
# --------------------------------
BCRYPT_COST=12
# Bcrypt hashing cost (10-14 recommended, higher = more secure but slower)

PASSWORD_MIN_LENGTH=8
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBER=true
PASSWORD_REQUIRE_SPECIAL=true

# --------------------------------
# Token Expiration Times
# --------------------------------

# Email verification token
VERIFICATION_TOKEN_EXPIRY=24h

# Password reset token
PASSWORD_RESET_TOKEN_EXPIRY=1h

# --------------------------------
# Email Configuration (SMTP)
# --------------------------------
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=your-email@gmail.com
SMTP_PASSWORD=your-app-password
SMTP_FROM_EMAIL=noreply@stegmaier-lms.com
SMTP_FROM_NAME=Stegmaier LMS

# Email templates
EMAIL_VERIFICATION_TEMPLATE=verification_email.html
EMAIL_PASSWORD_RESET_TEMPLATE=password_reset_email.html

# --------------------------------
# CORS Configuration
# --------------------------------
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5173
# Comma-separated list of allowed origins

CORS_ALLOW_CREDENTIALS=true
CORS_MAX_AGE=86400

# --------------------------------
# Rate Limiting
# --------------------------------
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_MINUTE=60
# Max requests per minute per IP

RATE_LIMIT_AUTH_REQUESTS_PER_MINUTE=5
# Stricter rate limit for auth endpoints

# --------------------------------
# Logging
# --------------------------------
LOG_LEVEL=debug
# Options: debug, info, warn, error, fatal

LOG_FORMAT=json
# Options: json, text

LOG_OUTPUT=stdout
# Options: stdout, file

LOG_FILE_PATH=./logs/app.log
# If LOG_OUTPUT=file

# --------------------------------
# File Upload
# --------------------------------
UPLOAD_MAX_SIZE=10485760
# Max file size in bytes (10MB = 10485760)

UPLOAD_ALLOWED_TYPES=image/jpeg,image/png,image/gif,application/pdf
# Comma-separated MIME types

UPLOAD_DESTINATION=./uploads
# Local storage path

# --------------------------------
# Storage (Cloud)
# --------------------------------
STORAGE_PROVIDER=local
# Options: local, s3, gcs, azure

# AWS S3 Configuration (if STORAGE_PROVIDER=s3)
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=your-access-key
AWS_SECRET_ACCESS_KEY=your-secret-key
AWS_S3_BUCKET=stegmaier-lms-uploads

# --------------------------------
# Redis (Cache) - Optional
# --------------------------------
REDIS_ENABLED=false
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_POOL_SIZE=10

# --------------------------------
# Monitoring & Observability
# --------------------------------

# Metrics
METRICS_ENABLED=true
METRICS_PORT=9090

# Tracing
TRACING_ENABLED=false
JAEGER_ENDPOINT=http://localhost:14268/api/traces

# Health Check
HEALTH_CHECK_PATH=/health

# --------------------------------
# Feature Flags
# --------------------------------
FEATURE_EMAIL_VERIFICATION=true
FEATURE_PASSWORD_RESET=true
FEATURE_TWO_FACTOR_AUTH=false
FEATURE_SOCIAL_LOGIN=false

# --------------------------------
# Multi-tenancy
# --------------------------------
TENANT_ISOLATION_MODE=database
# Options: database, schema, discriminator

DEFAULT_TENANT_ID=default
# Tenant ID for single-tenant mode or fallback

# --------------------------------
# Background Jobs (Optional)
# --------------------------------
JOBS_ENABLED=false
JOBS_WORKER_COUNT=5
JOBS_QUEUE_SIZE=100

# --------------------------------
# Development Tools
# --------------------------------
DEBUG_MODE=true
# Enable debug endpoints and verbose logging

SWAGGER_ENABLED=true
# Enable Swagger/OpenAPI documentation

PROFILER_ENABLED=false
# Enable pprof profiler endpoints

# --------------------------------
# Testing
# --------------------------------
TEST_DB_NAME=stegmaier_control_test
TEST_DB_DROP_AFTER=true
# Drop test database after tests complete

# --------------------------------
# Migrations
# --------------------------------
MIGRATIONS_DIR=./migrations
AUTO_MIGRATE=true
# Automatically run migrations on startup (disable in production)

MIGRATIONS_TABLE=schema_migrations
# Name of migrations tracking table

# --------------------------------
# Third-party Integrations
# --------------------------------

# Payment Gateway (Stripe)
STRIPE_ENABLED=false
STRIPE_SECRET_KEY=sk_test_your_key
STRIPE_PUBLISHABLE_KEY=pk_test_your_key
STRIPE_WEBHOOK_SECRET=whsec_your_secret

# Analytics
ANALYTICS_ENABLED=false
GOOGLE_ANALYTICS_ID=UA-XXXXX-Y

# --------------------------------
# Localization
# --------------------------------
DEFAULT_LANGUAGE=es
# Options: es (Spanish), en (English)

DEFAULT_TIMEZONE=America/Santiago
SUPPORTED_LANGUAGES=es,en

# --------------------------------
# Notifications
# --------------------------------
NOTIFICATIONS_ENABLED=true

# Push Notifications (Firebase)
FIREBASE_ENABLED=false
FIREBASE_PROJECT_ID=your-project-id
FIREBASE_CREDENTIALS_FILE=./configs/firebase-credentials.json

# SMS (Twilio)
SMS_ENABLED=false
TWILIO_ACCOUNT_SID=your-account-sid
TWILIO_AUTH_TOKEN=your-auth-token
TWILIO_PHONE_NUMBER=+1234567890

# --------------------------------
# Security Headers
# --------------------------------
SECURITY_HSTS_ENABLED=true
SECURITY_HSTS_MAX_AGE=31536000
SECURITY_FRAME_DENY=true
SECURITY_CONTENT_TYPE_NOSNIFF=true
SECURITY_XSS_PROTECTION=true

# --------------------------------
# Session
# --------------------------------
SESSION_SECRET=your-session-secret-key-change-in-production
SESSION_DURATION=24h
SESSION_COOKIE_SECURE=false
# Set to true in production with HTTPS

# --------------------------------
# API Versioning
# --------------------------------
API_VERSION=v1
API_PREFIX=/api
# Full API path will be: /api/v1/*

# --------------------------------
# Graceful Shutdown
# --------------------------------
SHUTDOWN_TIMEOUT=30s
# Time to wait for ongoing requests before shutdown

# --------------------------------
# Custom Application Settings
# --------------------------------

# Enrollment
MAX_ENROLLMENTS_PER_USER=10
ALLOW_FREE_COURSES=true

# Courses
COURSE_SLUG_LENGTH=50
COURSE_DESCRIPTION_MAX_LENGTH=5000

# Quizzes
QUIZ_MAX_ATTEMPTS=3
QUIZ_TIME_LIMIT_DEFAULT=60
# In minutes

# Certificates
CERTIFICATE_TEMPLATE_PATH=./templates/certificates
CERTIFICATE_SIGNATURE_PATH=./assets/signature.png

# --------------------------------
# Notes for Production
# --------------------------------
#
# 1. Change ALL secrets and passwords
# 2. Set ENV=production
# 3. Enable SSL: DB_SSL_MODE=require
# 4. Set SESSION_COOKIE_SECURE=true
# 5. Disable DEBUG_MODE=false
# 6. Set appropriate CORS_ALLOWED_ORIGINS
# 7. Enable rate limiting
# 8. Configure proper logging
# 9. Set up monitoring and alerts
# 10. Use environment-specific configs
#
